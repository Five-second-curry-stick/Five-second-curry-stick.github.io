<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>DL8 - 迁移学习、多任务学习、端到端深度学习 | 杨健豪-blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Welcome to MyBlog! This article was writed to take note my study of Machine Learning on Cousera.  1. 迁移学习1.1 什么是迁移学习 是有时你可以把在一个任务中神经网络 学习到的东西，应用到另一个任务中去。 比如，你可以让神经网络 学习去识别物体，比如猫，然后用学习到的 （一部分）知识 来帮助你更好">
<meta property="og:type" content="article">
<meta property="og:title" content="DL8 - 迁移学习、多任务学习、端到端深度学习">
<meta property="og:url" content="http://example.com/2019/09/09/DL8%20-%20%E8%BF%81%E7%A7%BB%E3%80%81%E5%A4%9A%E4%BB%BB%E5%8A%A1%E3%80%81%E7%AB%AF%E5%88%B0%E7%AB%AF/index.html">
<meta property="og:site_name" content="杨健豪-blog">
<meta property="og:description" content="Welcome to MyBlog! This article was writed to take note my study of Machine Learning on Cousera.  1. 迁移学习1.1 什么是迁移学习 是有时你可以把在一个任务中神经网络 学习到的东西，应用到另一个任务中去。 比如，你可以让神经网络 学习去识别物体，比如猫，然后用学习到的 （一部分）知识 来帮助你更好">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://i.loli.net/2019/09/09/Iuohf9DQGxSL4PO.png">
<meta property="og:image" content="https://i.loli.net/2019/09/09/pGYs6W9uzi2O5XC.png">
<meta property="og:image" content="https://i.loli.net/2019/09/09/EoCB1hFp3YaOxVA.png">
<meta property="og:image" content="https://i.loli.net/2019/09/10/AvbUWpqhQwZiCjV.png">
<meta property="og:image" content="https://i.loli.net/2019/09/10/qfM29lj1mAUpPaQ.png">
<meta property="article:published_time" content="2019-09-09T14:06:17.000Z">
<meta property="article:modified_time" content="2019-09-20T01:13:42.000Z">
<meta property="article:author" content="Jianhao Yang">
<meta property="article:tag" content="deeplearning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/09/09/Iuohf9DQGxSL4PO.png">
  
    <link rel="alternate" href="/atom.xml" title="杨健豪-blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">杨健豪-blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-DL8 - 迁移、多任务、端到端" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/09/09/DL8%20-%20%E8%BF%81%E7%A7%BB%E3%80%81%E5%A4%9A%E4%BB%BB%E5%8A%A1%E3%80%81%E7%AB%AF%E5%88%B0%E7%AB%AF/" class="article-date">
  <time datetime="2019-09-09T14:06:17.000Z" itemprop="datePublished">2019-09-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/deeplearning/">deeplearning</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      DL8 - 迁移学习、多任务学习、端到端深度学习
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://five-second-curry-stick.github.io/">MyBlog</a>! This article was writed to take note my study of Machine Learning on <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/machine-learning-projects/lecture/WNPap/transfer-learning">Cousera</a>.</p>
<hr>
<h3 id="1-迁移学习"><a href="#1-迁移学习" class="headerlink" title="1. 迁移学习"></a>1. 迁移学习</h3><h4 id="1-1-什么是迁移学习"><a href="#1-1-什么是迁移学习" class="headerlink" title="1.1 什么是迁移学习"></a>1.1 什么是迁移学习</h4><blockquote>
<p>是有时你可以把在一个任务中神经网络 学习到的东西，应用到另一个任务中去。 比如，你可以让神经网络 学习去识别物体，比如猫，然后用学习到的 （一部分）知识 来帮助你更好地识别X射线的结果。 这就是所谓的迁移学习。</p>
</blockquote>
<blockquote>
<p>例如放射扫描结果的诊断过程 即真实地读取X光扫描图像 你可以做的就是，取出这个神经网络的最后一层 并移除掉这一层以及其相关的权重 然后为最后一层神经网络创建一个新的随机初始化的权重 使用新建的这个输出层来进行放射结果的诊断 所以，具体来说，在训练模型的第一阶段， 当你在做图像识别的任务时， 你训练了所有常用的神经网络的参数，所有权值 所有层，然后这个模型 现在能够做出图像识别的预测。 训练得出了这样一个神经网络之后， 要实现迁移学习，你现在需要把数据集X和Y 设定为放射影像。 现在的Y是你想要预测的诊断结果， 你要做的是初始化最后一层的权值 我们叫这个为WL 和PL。 然后现在，重新在新的数据集上训练这个神经网络， 就是新的放射数据集上。</p>
</blockquote>
<blockquote>
<p>你有几种方法来重新训练这个放射数据的神经网络。 如果你只有一个小的放射数据集， 你可以只重新训练最后一层的权值，就是WL 和PL，同时保留其它所有参数。 如果你有足够的数据， 你也可以重新训练神经网络的其余所有层。 我们的经验就是如果你有一个小规模的数据集， 那么就去重新训练最后一层和输出层的神经网络， 或者你也可以训练最后一到两层的神经网络。 但是如果你有大量的数据， 你或许可以对这个神经网络的所有参数都进行重新训练。 要是你对神经网络的所有参数进行重新训练， 那么这样训练的初始化阶段 有时候被我们叫做预训练（pre-training） 原因是，你在是使用图像识别的数据 来预初始化（pre-initialize）或者说预训练神经网络的权重。 然后如果你在之后对所有的权重进行更新， 那么在放射扫描的数据上的训练有时候被我们叫做微调（fine tuning) 所以有时候你会在深度学习领域听到预训练（pre-training）和微调（fine tuning）这些词， 上面我所说的就是他们在迁移学习中 表达的真正含义。</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/09/Iuohf9DQGxSL4PO.png"></p>
</blockquote>
</blockquote>
<blockquote>
<p>一个迁移学习不适用的例子是， （上面讲到的）数据规模被颠倒过来的时候。</p>
</blockquote>
<h4 id="1-2-迁移学习什么时候适用"><a href="#1-2-迁移学习什么时候适用" class="headerlink" title="1.2 迁移学习什么时候适用"></a>1.2 迁移学习什么时候适用</h4><ul>
<li><p>如果你尝试 从某个任务A中学习到的信息迁移到某个任务B中， 那么当任务A和任务B在有相同的输入时，迁移学习才能适用。</p>
</li>
<li><p>必须在任务A比任务B有更多的数据时，迁移学习才适用。 所有条件都是在想要把任务B做好的前提下 因为在任务B中的数据比在任务A中更加地有价值， 通常你需要为任务A准备更多的数据，因为 在任务A中的样本比任务B中的样本价值更低。</p>
</li>
<li><p>迁移学习更加适用的场景 是当你认为，任务A中的低层次特征会帮助任务B达成目标。</p>
</li>
</ul>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/09/pGYs6W9uzi2O5XC.png"></p>
</blockquote>
</blockquote>
<h3 id="2-多任务学习"><a href="#2-多任务学习" class="headerlink" title="2. 多任务学习"></a>2. 多任务学习</h3><h4 id="2-1-什么是多任务学习"><a href="#2-1-什么是多任务学习" class="headerlink" title="2.1 什么是多任务学习"></a>2.1 什么是多任务学习</h4><pre><code>在多任务学习中,你（多个任务）一起开始 尝试让一个神经网络同时做几件事 
然后,每个任务将会帮助完成其他任务。 我们来看个例子让我们来看一个例子</code></pre>
<blockquote>
<p> 你可以有一个神经网络以x作为输入和 输出为四维的y。 请注意这里的输出,我已经绘制了四节点。 第一个节点,我们试图检测是否有行人 在这张图片中 第二个输出会检测到是否有辆车 还会检测到是否有个停车标志和红绿灯</p>
</blockquote>
<blockquote>
<p>所以这里的y^是四维的。为了训练这个神经网络,你需要定义 这个神经网络的损失函数 预测输出的y^(i)是4x1维的。 损失是整个训练集的平均损失 为1除以m，乘以从i=1到m的总和 j从1到4各自预测的损失</p>
</blockquote>
<blockquote>
<p>它只是将4个部分行人、车、停车标志 红绿灯进行相加 这里的L是普通的逻辑斯蒂损失函数。</p>
</blockquote>
<blockquote>
<p>把这写下来 所以就是 yj(i)logŷj(i)+(1-yj(i))log(1-ŷj(i))</p>
</blockquote>
<blockquote>
<p>和softmax回归区别是,不像softmax 回归,它将单个标签分配给单个示例。 这一个图像可以有多个标签。</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/09/EoCB1hFp3YaOxVA.png"></p>
</blockquote>
</blockquote>
<h4 id="2-2-什么时候适用多任务学习"><a href="#2-2-什么时候适用多任务学习" class="headerlink" title="2.2 什么时候适用多任务学习"></a>2.2 什么时候适用多任务学习</h4><blockquote>
<p>1 你要训练一系列的任务可以 共享一些低层次的特征 自动驾驶的例子中,在识别交通灯 汽车和行人时,都有相似的特征 这可以帮你识别停车标志，因为他们都是道路特征</p>
</blockquote>
<blockquote>
<p>2 其次——这不是硬性的规则,所以不总是存在的—— 但我看到很多成功的多任务学习，他们 每个单项任务的数据量非常相似。</p>
</blockquote>
<blockquote>
<p> 如果神经网络不够大，多任务学习 与单项训练相比会损害准确率。 但如果你训练足够大的神经网络,那多任务学习 应该不会或很少影响性能。 与你分别单独训练不同任务相比， 它实际上能够提高性能。 这就是多任务学习。 实际上多任务学习要比迁移学习用得少得多。</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/10/AvbUWpqhQwZiCjV.png"></p>
</blockquote>
</blockquote>
<h3 id="3-“端到端”的机器学习"><a href="#3-“端到端”的机器学习" class="headerlink" title="3. “端到端”的机器学习"></a>3. “端到端”的机器学习</h3><blockquote>
<p>什么是“端到端“的深度学习呢？ 简单地说，我们有一些数据处理系统 或者是由多个阶段组成的学习系统 端到端的深度学习做的 就是它可以捕获所有的阶段 并且，通常可以将其替代为单个神经网络 也就是说运行速度更快 </p>
</blockquote>
<blockquote>
<p>所以，如果端到端深度学习可行， 可以非常有效和简化系统，且 不用建立很多手工设计的单个组件。 但是它不是万能的， 它并不总是有效。</p>
</blockquote>
<h4 id="3-2-端到端的优缺点"><a href="#3-2-端到端的优缺点" class="headerlink" title="3.2 端到端的优缺点"></a>3.2 端到端的优缺点</h4><blockquote>
<p>优点1: 端到端学习真正地让数据发挥主导作用 所以如果你有足够的(X, Y)的数据 那么不论那个能最好地将X映射到Y的函数是什么样子 只要你有足够大的神经网络 顺利的话，神经网络都能拟合出来 通过单纯的使用机器学习方法 你的神经网络能够更好从输入的X-&gt;Y中 学习到数据内在的统计学特性 而不是被迫去反映人的先见 </p>
<p>优点2：所需的人类动手设计的组件变的更少了 所以这可以简化你的设计工作流程 意味着你不需要话大量的时间去动手设计特征 手工设计这些中间表示形式</p>
</blockquote>
<blockquote>
<p>缺点1：第一，端到端学习需要大量的数据 所以为了使用机器学习直接得出X到Y的映射 你或许需要大量的(X，Y)数据 </p>
</blockquote>
<blockquote>
<p>缺点2: 它排除了一些具有潜在用途的手工设计组件 所以机器学习研究人员往往会轻视手工设计的组件 但是如果你没有足够的数据 那么你的学习算法就不能够洞悉你数据中的规律 如果你的训练集很小 所以手工设计的组件的确是一条可行之路 去将人工知识融入到算法中 而且这并不总是个坏主意 我认为学习算法有两个主要的知识来源 一个是数据，另一个是你手工设计的东西 这些东西可以是算法中的组件，或者是特征，或者是其他的东西 所以如果你有很多很多的数据 手工设计就没那么重要了，但是如果你没有那么多的数据 那么有一个精心手工设计的系统实际上可以让人们向 算法中注入人类关于这个问题的知识</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/10/qfM29lj1mAUpPaQ.png"></p>
</blockquote>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/09/09/DL8%20-%20%E8%BF%81%E7%A7%BB%E3%80%81%E5%A4%9A%E4%BB%BB%E5%8A%A1%E3%80%81%E7%AB%AF%E5%88%B0%E7%AB%AF/" data-id="ckgqfij2m000q7545blgjak98" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deeplearning/" rel="tag">deeplearning</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/09/10/DL9%20-%20%E5%BE%AA%E7%8E%AF%E5%BA%8F%E5%88%97%E6%A8%A1%E5%9E%8B/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          DL9 - 循环序列模型
        
      </div>
    </a>
  
  
    <a href="/2019/09/09/DL7%20-%20%E6%9E%84%E9%80%A0%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E9%A1%B9%E7%9B%AE%EF%BC%882%EF%BC%89/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">DL7 - 构造机器学习项目（2）</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine-Learning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/deeplearning/">deeplearning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%96/">数值优化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/">数学之美</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A3/">文献理解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/cousera/" rel="tag">cousera</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deeplearning/" rel="tag">deeplearning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%96/" rel="tag">数值优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/" rel="tag">数学之美</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A3/" rel="tag">文献理解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/cousera/" style="font-size: 15px;">cousera</a> <a href="/tags/deeplearning/" style="font-size: 20px;">deeplearning</a> <a href="/tags/python/" style="font-size: 12.5px;">python</a> <a href="/tags/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%96/" style="font-size: 12.5px;">数值优化</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/" style="font-size: 17.5px;">数学之美</a> <a href="/tags/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A3/" style="font-size: 10px;">文献理解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/10/09/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%964%20-%20%E7%BA%BF%E6%90%9C%E7%B4%A2%E6%96%B9%E6%B3%95%E7%9A%84%E6%94%B6%E6%95%9B%E6%80%A7%E5%92%8C%E6%94%B6%E6%95%9B%E9%80%9F%E5%BA%A6/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/10/05/%E4%B8%8D%E5%AE%8C%E6%95%B4/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A31%20-%20LCF/">文献理解 - LCF</a>
          </li>
        
          <li>
            <a href="/2019/09/26/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E16%20-%20%E4%BF%A1%E6%81%AF%E6%8C%87%E7%BA%B9/">数学之美16 - 信息指纹及其应用</a>
          </li>
        
          <li>
            <a href="/2019/09/25/DL12%20-%20CNN%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">DL12 - CNN基础知识</a>
          </li>
        
          <li>
            <a href="/2019/09/22/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%963%20-%20%E7%BA%BF%E6%80%A7%E6%90%9C%E7%B4%A2%E6%96%B9%E6%B3%95/">数值优化3 - 线搜索方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Jianhao Yang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>