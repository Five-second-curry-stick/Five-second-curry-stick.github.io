<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>ML2 - 线性回归模型 | 个人网站-杨健豪</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Welcome to MyBlog! This article was writed to take note my study of Machine Learning on Cousera.  1. 单元 线性回归模型 linear regression h表示映射关系       1.1 代价函数      模型所预测的值与训练集中实际值之间的差距（下图中蓝线所指）就是建模误差（modelin">
<meta property="og:type" content="article">
<meta property="og:title" content="ML2 - 线性回归模型">
<meta property="og:url" content="http://example.com/2019/08/31/ml2-model%20&%20cost_function/index.html">
<meta property="og:site_name" content="个人网站-杨健豪">
<meta property="og:description" content="Welcome to MyBlog! This article was writed to take note my study of Machine Learning on Cousera.  1. 单元 线性回归模型 linear regression h表示映射关系       1.1 代价函数      模型所预测的值与训练集中实际值之间的差距（下图中蓝线所指）就是建模误差（modelin">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2019/08/31/8p2wRfWUzrc1Vuk.png">
<meta property="og:image" content="https://i.loli.net/2019/09/03/2rXLciOMK6DtICp.png">
<meta property="og:image" content="https://i.loli.net/2019/09/03/aRMZ5Ykhg9WDCeU.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/BGDMc4FgH1dmLQO.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/oLtJ1crEYwgR3IM.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/dYTN1lHDRUAWMQE.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/7AkbFeJryxTBYvO.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/e5GDC3ZjN29EvST.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/SIHqo2VXGbfxOwJ.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/1CrGXmAplnWcF5D.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/IbYnPl5LfCQEv7o.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/UBqtG6pwixNRo3V.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/k75MyQtjdXgsxlC.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/q4IEYdNQCme3aZ9.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/jnqKFwdAbZQaeki.png">
<meta property="og:image" content="https://i.loli.net/2019/09/04/w5sBSWVDGgda74r.png">
<meta property="article:published_time" content="2019-08-31T02:25:58.000Z">
<meta property="article:modified_time" content="2019-09-04T23:58:37.000Z">
<meta property="article:author" content="Jianhao Yang">
<meta property="article:tag" content="cousera">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2019/08/31/8p2wRfWUzrc1Vuk.png">
  
    <link rel="alternate" href="/atom.xml" title="个人网站-杨健豪" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">个人网站-杨健豪</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ml2-model &amp; cost_function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/31/ml2-model%20&%20cost_function/" class="article-date">
  <time datetime="2019-08-31T02:25:58.000Z" itemprop="datePublished">2019-08-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Machine-Learning/">Machine-Learning</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ML2 - 线性回归模型
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://five-second-curry-stick.github.io/">MyBlog</a>! This article was writed to take note my study of Machine Learning on <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/machine-learning/supplement/1O0Bk/unsupervised-learning">Cousera</a>.</p>
<hr>
<h3 id="1-单元-线性回归模型-linear-regression"><a href="#1-单元-线性回归模型-linear-regression" class="headerlink" title="1. 单元 线性回归模型 linear regression"></a>1. 单元 线性回归模型 linear regression</h3><blockquote>
<p>h表示映射关系</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/08/31/8p2wRfWUzrc1Vuk.png"></p>
</blockquote>
</blockquote>
<h4 id="1-1-代价函数"><a href="#1-1-代价函数" class="headerlink" title="1.1 代价函数"></a>1.1 代价函数</h4><blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/03/2rXLciOMK6DtICp.png"></p>
</blockquote>
</blockquote>
<blockquote>
<p>模型所预测的值与训练集中实际值之间的差距（下图中蓝线所指）就是建模误差（modeling error）</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/03/aRMZ5Ykhg9WDCeU.png"></p>
</blockquote>
</blockquote>
<blockquote>
<p>为了选出使得modeling error的平方和最小的模型参数。即代价函数：</p>
</blockquote>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/BGDMc4FgH1dmLQO.png"></p>
</blockquote>
</blockquote>
<h4 id="1-2-梯度下降"><a href="#1-2-梯度下降" class="headerlink" title="1.2 梯度下降"></a>1.2 梯度下降</h4><blockquote>
<p>一种有效的算法，能够自动找出使代价函数J取最小值的参数θ0和θ1.</p>
</blockquote>
<h3 id="2-多元线性回归"><a href="#2-多元线性回归" class="headerlink" title="2. 多元线性回归"></a>2. 多元线性回归</h3><h4 id="2-1-多元线性回归的向量形式"><a href="#2-1-多元线性回归的向量形式" class="headerlink" title="2.1 多元线性回归的向量形式"></a>2.1 多元线性回归的向量形式</h4><blockquote>
<p>转换成向量形式，如下：</p>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/oLtJ1crEYwgR3IM.png"></p>
</blockquote>
</blockquote>
<h4 id="2-2-用梯度下降解决多特征的线性回归问题"><a href="#2-2-用梯度下降解决多特征的线性回归问题" class="headerlink" title="2.2 用梯度下降解决多特征的线性回归问题"></a>2.2 用梯度下降解决多特征的线性回归问题</h4><blockquote>
<p><img src="https://i.loli.net/2019/09/04/dYTN1lHDRUAWMQE.png"></p>
</blockquote>
<h3 id="3-特征缩放"><a href="#3-特征缩放" class="headerlink" title="3. 特征缩放"></a>3. 特征缩放</h3><h4 id="3-1-缩放目的"><a href="#3-1-缩放目的" class="headerlink" title="3.1 缩放目的"></a>3.1 缩放目的</h4><blockquote>
<p>这个问题有多个特征 如果你能确保这些特征 都处在一个相近的范围 我的意思是确保 不同特征的取值 在相近的范围内<br>下面举一个反面例子：</p>
<blockquote>
<p>假如你有一个具有两个特征的问题 其中 x1 是房屋面积大小 它的取值 在0到2000之间 x2 是卧室的数量 可能这个值 取值范围在1到5之间 如果你画出代价函数 J(θ) 的轮廓图<br><img src="https://i.loli.net/2019/09/04/7AkbFeJryxTBYvO.png"></p>
</blockquote>
</blockquote>
<h4 id="3-2-缩放（特征缩放其实并不需要太过准确，只是为了加速梯度下降）"><a href="#3-2-缩放（特征缩放其实并不需要太过准确，只是为了加速梯度下降）" class="headerlink" title="3.2 缩放（特征缩放其实并不需要太过准确，只是为了加速梯度下降）"></a>3.2 缩放（特征缩放其实并不需要太过准确，只是为了加速梯度下降）</h4><pre><code>1. 不用过于担心 你的特征是否在完全 相同的范围或区间内 
但是只要他们都 只要它们足够接近的话 梯度下降法就会正常地工作</code></pre>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/e5GDC3ZjN29EvST.png"></p>
</blockquote>
</blockquote>
<pre><code>2. 均值规范化处理
其中，S为标准差（实际上，用最大值-最小值也是可以的），miu为均值</code></pre>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/SIHqo2VXGbfxOwJ.png"></p>
</blockquote>
</blockquote>
<h3 id="4-学习率alpha的选择"><a href="#4-学习率alpha的选择" class="headerlink" title="4. 学习率alpha的选择"></a>4. 学习率alpha的选择</h3><blockquote>
<p>通过损失函数的图像判断</p>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/1CrGXmAplnWcF5D.png"><br><img src="https://i.loli.net/2019/09/04/IbYnPl5LfCQEv7o.png"></p>
</blockquote>
</blockquote>
<h3 id="5-特征-和-多项式回归（polynomial-regression）【和多元相对应】"><a href="#5-特征-和-多项式回归（polynomial-regression）【和多元相对应】" class="headerlink" title="5. 特征 和 多项式回归（polynomial regression）【和多元相对应】"></a>5. 特征 和 多项式回归（polynomial regression）【和多元相对应】</h3><h4 id="5-1-选择特征的方法"><a href="#5-1-选择特征的方法" class="headerlink" title="5.1 选择特征的方法"></a>5.1 选择特征的方法</h4><blockquote>
<p>有时 通过定义 新的特征 你确实会得到一个更好的模型 与选择特征的想法 </p>
</blockquote>
<pre><code>We can combine multiple features into one. For example, we can combine x1 and x2 into a new feature x3 by taking x1⋅x2.

以预测房价为例 假设你有两个特征 分别是房子临街的宽度和垂直宽度 这就是我们想要卖出的房子的图片 临街宽度 被定义为这个距离 其实就是它的宽度 或者说是 你拥有的土地的宽度 如果这块地都是你的的话 而这所房子的 纵向深度就是 你的房子的深度 这是正面的宽度 这是深度 我们称之为临街宽度和纵深 你可能会 像这样 建立一个 线性回归模型 其中临街宽度 是你的第一个特征x1 纵深是你的第二个 特征x2 但当我们在 运用线性回归时 你不一定非要直接用 给出的 x1 和 x2 作为特征 其实你可以自己创造新的特征 因此 如果我要预测 房子的价格 我真正要需做的 也许是 确定真正能够决定 我房子大小 或者说我土地大小 的因素是什么 因此 我可能会创造一个新的特征 我称之为 x 它是临街宽度与纵深的乘积 </code></pre>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/UBqtG6pwixNRo3V.png"></p>
</blockquote>
</blockquote>
<h4 id="5-2-如何得到不同的学习算法"><a href="#5-2-如何得到不同的学习算法" class="headerlink" title="5.2 如何得到不同的学习算法"></a>5.2 如何得到不同的学习算法</h4><blockquote>
<p>如何将一个 多项式 如一个二次函数 或一个三次函数拟合到你的数据</p>
</blockquote>
<pre><code>Our hypothesis function need not be linear (a straight line) if that does not fit the data well.
We can change the behavior or curve of our hypothesis function by making it a quadratic, cubic or square root function (or any other form).</code></pre>
<blockquote>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/k75MyQtjdXgsxlC.png"></p>
</blockquote>
</blockquote>
<h3 id="6-正规方程"><a href="#6-正规方程" class="headerlink" title="6. 正规方程"></a>6. 正规方程</h3><blockquote>
<p>对于某些线性回归问题 它给出了一个更好的方法 求出参数 θ 的最优解<br>相对于梯度下降一步步求到最优解，正规方程法，提供了一种求theta的解析接发，可以一次性求解theta的最优解</p>
</blockquote>
<h4 id="6-1-正规方程直观理解"><a href="#6-1-正规方程直观理解" class="headerlink" title="6.1 正规方程直观理解"></a>6.1 正规方程直观理解</h4><blockquote>
<p><img src="https://i.loli.net/2019/09/04/q4IEYdNQCme3aZ9.png"><br><img src="https://i.loli.net/2019/09/04/jnqKFwdAbZQaeki.png"></p>
</blockquote>
<h4 id="6-2-如何选择梯度下降-和-正规方程法-只适用于线性回归"><a href="#6-2-如何选择梯度下降-和-正规方程法-只适用于线性回归" class="headerlink" title="6.2 如何选择梯度下降 和 正规方程法(只适用于线性回归)"></a>6.2 如何选择梯度下降 和 正规方程法(只适用于线性回归)</h4><blockquote>
<p>只要特征变量的数目并不大 正规方程是一个很好的 计算参数 θ 的替代方法 具体地说 只要特征变量数量小于一万 具体地说 只要特征变量数量小于一万 我通常使用正规方程法 我通常使用正规方程法 而不使用梯度下降法</p>
<blockquote>
<p><img src="https://i.loli.net/2019/09/04/w5sBSWVDGgda74r.png"></p>
</blockquote>
</blockquote>
<h4 id="6-3-正规方程的不可逆性"><a href="#6-3-正规方程的不可逆性" class="headerlink" title="6.3 正规方程的不可逆性"></a>6.3 正规方程的不可逆性</h4><pre><code>当你发现的矩阵X&#39;X的结果是奇异矩阵 或者找到的其它矩阵是不可逆的 我会建议你这么做 首先 看特征值里是否有一些多余的特征</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/08/31/ml2-model%20&%20cost_function/" data-id="ckgqfij2r001475459utxh5i5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cousera/" rel="tag">cousera</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/09/06/ml3%20-%20classification/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ML3 - 分类问题（逻辑回归）
        
      </div>
    </a>
  
  
    <a href="/2019/08/24/DL5%20-%20SoftmaxRegression/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">DL5 - softmax回归、深度学习框架</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine-Learning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/deeplearning/">deeplearning</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%96/">数值优化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/">数学之美</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A3/">文献理解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/cousera/" rel="tag">cousera</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/deeplearning/" rel="tag">deeplearning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%96/" rel="tag">数值优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/" rel="tag">数学之美</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A3/" rel="tag">文献理解</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/cousera/" style="font-size: 15px;">cousera</a> <a href="/tags/deeplearning/" style="font-size: 20px;">deeplearning</a> <a href="/tags/python/" style="font-size: 12.5px;">python</a> <a href="/tags/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%96/" style="font-size: 12.5px;">数值优化</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/" style="font-size: 17.5px;">数学之美</a> <a href="/tags/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A3/" style="font-size: 10px;">文献理解</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/10/09/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%964%20-%20%E7%BA%BF%E6%90%9C%E7%B4%A2%E6%96%B9%E6%B3%95%E7%9A%84%E6%94%B6%E6%95%9B%E6%80%A7%E5%92%8C%E6%94%B6%E6%95%9B%E9%80%9F%E5%BA%A6/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/10/05/%E4%B8%8D%E5%AE%8C%E6%95%B4/%E6%96%87%E7%8C%AE%E7%90%86%E8%A7%A31%20-%20LCF/">文献理解 - LCF</a>
          </li>
        
          <li>
            <a href="/2019/09/26/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E16%20-%20%E4%BF%A1%E6%81%AF%E6%8C%87%E7%BA%B9/">数学之美16 - 信息指纹及其应用</a>
          </li>
        
          <li>
            <a href="/2019/09/25/DL12%20-%20CNN%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">DL12 - CNN基础知识</a>
          </li>
        
          <li>
            <a href="/2019/09/22/%E6%95%B0%E5%80%BC%E4%BC%98%E5%8C%963%20-%20%E7%BA%BF%E6%80%A7%E6%90%9C%E7%B4%A2%E6%96%B9%E6%B3%95/">数值优化3 - 线搜索方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Jianhao Yang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>